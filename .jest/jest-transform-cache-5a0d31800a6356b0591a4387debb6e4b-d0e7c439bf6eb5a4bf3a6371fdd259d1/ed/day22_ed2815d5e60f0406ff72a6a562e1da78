f859285f02c892cd56c103e3e9b78f3a
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.part1 = part1;
exports.part2 = part2;

var _jsCombinatorics = _interopRequireDefault(require("js-combinatorics"));

function _interopRequireDefault(obj) { return obj && obj.__esModule ? obj : { default: obj }; }

function parse(input) {
  return input.split('\n').slice(2).map(x => {
    const fix = x => parseInt(x.replace(/.$/, ''), 10);

    const [name, size, used, avail, use] = x.split(/\s+/);
    return {
      name,
      size: fix(size),
      used: fix(used),
      avail: fix(avail),
      use
    };
  });
}

function solve1(nodes) {
  const pairs = _jsCombinatorics.default.bigCombination(nodes, 2).toArray();

  return pairs.concat(pairs.map(x => [x[1], x[0]])).filter(x => {
    return x[0].used !== 0 && x[0].used <= x[1].avail;
  });
}

function cellId({
  x,
  y
}) {
  return `${x}-${y}`;
}

function build(nodes) {
  const big = Math.floor(Math.log10(nodes.sort((a, b) => a.used - b.used)[nodes.length - 1].used));
  const map = {};
  let start,
      data = {
    x: 0,
    y: 0
  };
  nodes.forEach(node => {
    const [x, y] = node.name.match(/x(\d+)-y(\d+)$/).slice(1).map(x => parseInt(x));
    map[cellId({
      x,
      y
    })] = {
      wall: Math.floor(Math.log10(node.used)) === big
    };
    start = node.used === 0 ? {
      x,
      y
    } : start;
    data = y === 0 && x > data.x ? {
      x,
      y
    } : data;
  });
  return {
    map,
    start,
    data
  };
}

function getNeighbors(map, point) {
  return [{
    x: point.x - 1,
    y: point.y,
    distance: point.distance + 1
  }, {
    x: point.x + 1,
    y: point.y,
    distance: point.distance + 1
  }, {
    x: point.x,
    y: point.y - 1,
    distance: point.distance + 1
  }, {
    x: point.x,
    y: point.y + 1,
    distance: point.distance + 1
  }].filter(p => map[cellId(p)]);
}

function shortest(map, source, destination) {
  let queue = [source];
  const visited = {
    [cellId(source)]: {
      distance: 0
    }
  };

  while (queue.length) {
    const next = queue.shift();

    if (next.x === destination.x && next.y === destination.y) {
      return visited[cellId(next)].distance;
    } else {
      const neighbors = getNeighbors(map, next).filter(x => !visited[cellId(x)]);
      const distance = visited[cellId(next)].distance + 1;
      neighbors.forEach(x => visited[cellId(x)] = {
        distance
      });
      queue = queue.concat(neighbors.filter(x => !map[cellId(x)].wall));
    }
  }

  return 0;
}

function part1(input) {
  const nodes = parse(input);
  return solve1(nodes).length;
}

function part2(input) {
  const nodes = parse(input);
  const {
    map,
    start,
    data
  } = build(nodes);
  return shortest(map, start, {
    x: data.x - 1,
    y: 0
  }) + 1 + 5 * (data.x - 1);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRheTIyLmpzIl0sIm5hbWVzIjpbInBhcnNlIiwiaW5wdXQiLCJzcGxpdCIsInNsaWNlIiwibWFwIiwieCIsImZpeCIsInBhcnNlSW50IiwicmVwbGFjZSIsIm5hbWUiLCJzaXplIiwidXNlZCIsImF2YWlsIiwidXNlIiwic29sdmUxIiwibm9kZXMiLCJwYWlycyIsIkNvbWJpbmF0b3JpY3MiLCJiaWdDb21iaW5hdGlvbiIsInRvQXJyYXkiLCJjb25jYXQiLCJmaWx0ZXIiLCJjZWxsSWQiLCJ5IiwiYnVpbGQiLCJiaWciLCJNYXRoIiwiZmxvb3IiLCJsb2cxMCIsInNvcnQiLCJhIiwiYiIsImxlbmd0aCIsInN0YXJ0IiwiZGF0YSIsImZvckVhY2giLCJub2RlIiwibWF0Y2giLCJ3YWxsIiwiZ2V0TmVpZ2hib3JzIiwicG9pbnQiLCJkaXN0YW5jZSIsInAiLCJzaG9ydGVzdCIsInNvdXJjZSIsImRlc3RpbmF0aW9uIiwicXVldWUiLCJ2aXNpdGVkIiwibmV4dCIsInNoaWZ0IiwibmVpZ2hib3JzIiwicGFydDEiLCJwYXJ0MiJdLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7QUFBQTs7OztBQUVBLFNBQVNBLEtBQVQsQ0FBZUMsS0FBZixFQUFzQjtBQUNwQixTQUFPQSxLQUFLLENBQ1RDLEtBREksQ0FDRSxJQURGLEVBRUpDLEtBRkksQ0FFRSxDQUZGLEVBR0pDLEdBSEksQ0FHQUMsQ0FBQyxJQUFJO0FBQ1IsVUFBTUMsR0FBRyxHQUFHRCxDQUFDLElBQUlFLFFBQVEsQ0FBQ0YsQ0FBQyxDQUFDRyxPQUFGLENBQVUsSUFBVixFQUFnQixFQUFoQixDQUFELEVBQXNCLEVBQXRCLENBQXpCOztBQUNBLFVBQU0sQ0FBQ0MsSUFBRCxFQUFPQyxJQUFQLEVBQWFDLElBQWIsRUFBbUJDLEtBQW5CLEVBQTBCQyxHQUExQixJQUFpQ1IsQ0FBQyxDQUFDSCxLQUFGLENBQVEsS0FBUixDQUF2QztBQUNBLFdBQU87QUFBRU8sTUFBQUEsSUFBRjtBQUFRQyxNQUFBQSxJQUFJLEVBQUVK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LEtBQWYsRUFBc0I7QUFDM0IsUUFBTWMsS0FBSyxHQUFHZixLQUFLLENBQUNDLEtBQUQsQ0FBbkI7QUFDQSxTQUFPYSxNQUFNLENBQUNDLEtBQUQsQ0FBTixDQUFjaUIsTUFBckI7QUFDRDs7QUFFTSxTQUFTb0IsS0FBVCxDQUFlbkQsS0FBZixFQUFzQjtBQUMzQixRQUFNYyxLQUFLLEdBQUdmLEtBQUssQ0FBQ0MsS0FBRCxDQUFuQjtBQUNBLFFBQU07QUFBRUcsSUFBQUEsR0FBRjtBQUFPNkIsSUFBQUEsS0FBUDtBQUFjQyxJQUFBQTtBQUFkLE1BQXVCVixLQUFLLENBQUNULEtBQUQsQ0FBbEM7QUFDQSxTQUFPNEIsUUFBUSxDQUFDdkMsR0FBRCxFQUFNNkIsS0FBTixFQUFhO0FBQUU1QixJQUFBQSxDQUFDLEVBQUU2QixJQUFJLENBQUM3QixDQUFMLEdBQVMsQ0FBZDtBQUFpQmtCLElBQUFBLENBQUMsRUFBRTtBQUFwQixHQUFiLENBQVIsR0FBZ0QsQ0FBaEQsR0FBb0QsS0FBS1csSUFBSSxDQUFDN0IsQ0FBTCxHQUFTLENBQWQsQ0FBM0Q7QUFDRCIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCBDb21iaW5hdG9yaWNzIGZyb20gJ2pzLWNvbWJpbmF0b3JpY3MnO1xuXG5mdW5jdGlvbiBwYXJzZShpbnB1dCkge1xuICByZXR1cm4gaW5wdXRcbiAgICAuc3BsaXQoJ1xcbicpXG4gICAgLnNsaWNlKDIpXG4gICAgLm1hcCh4ID0+IHtcbiAgICAgIGNvbnN0IGZpeCA9IHggPT4gcGFyc2VJbnQoeC5yZXBsYWNlKC8uJC8sICcnKSwgMTApO1xuICAgICAgY29uc3QgW25hbWUsIHNpemUsIHVzZWQsIGF2YWlsLCB1c2VdID0geC5zcGxpdCgvXFxzKy8pO1xuICAgICAgcmV0dXJuIHsgbmFtZSwgc2l6ZTogZml4KHNpemUpLCB1c2VkOiBmaXgodXNlZCksIGF2YWlsOiBmaXgoYXZhaWwpLCB1c2UgfTtcbiAgICB9KTtcbn1cblxuZnVuY3Rpb24gc29sdmUxKG5vZGVzKSB7XG4gIGNvbnN0IHBhaXJzID0gQ29tYmluYXRvcmljcy5iaWdDb21iaW5hdGlvbihub2RlcywgMikudG9BcnJheSgpO1xuICByZXR1cm4gcGFpcnMuY29uY2F0KHBhaXJzLm1hcCh4ID0+IFt4WzFdLCB4WzBdXSkpLmZpbHRlcih4ID0+IHtcbiAgICByZXR1cm4geFswXS51c2VkICE9PSAwICYmIHhbMF0udXNlZCA8PSB4WzFdLmF2YWlsO1xuICB9KTtcbn1cblxuZnVuY3Rpb24gY2VsbElkKHsgeCwgeSB9KSB7XG4gIHJldHVybiBgJHt4fS0ke3l9YDtcbn1cblxuZnVuY3Rpb24gYnVpbGQobm9kZXMpIHtcbiAgY29uc3QgYmlnID0gTWF0aC5mbG9vcihcbiAgICBNYXRoLmxvZzEwKG5vZGVzLnNvcnQoKGEsIGIpID0+IGEudXNlZCAtIGIudXNlZClbbm9kZXMubGVuZ3RoIC0gMV0udXNlZCksXG4gICk7XG4gIGNvbnN0IG1hcCA9IHt9O1xuICBsZXQgc3RhcnQsXG4gICAgZGF0YSA9IHsgeDogMCwgeTogMCB9O1xuICBub2Rlcy5mb3JFYWNoKG5vZGUgPT4ge1xuICAgIGNvbnN0IFt4LCB5XSA9IG5vZGUubmFtZVxuICAgICAgLm1hdGNoKC94KFxcZCspLXkoXFxkKykkLylcbiAgICAgIC5zbGljZSgxKVxuICAgICAgLm1hcCh4ID0+IHBhcnNlSW50KHgpKTtcbiAgICBtYXBbY2VsbElkKHsgeCwgeSB9KV0gPSB7IHdhbGw6IE1hdGguZmxvb3IoTWF0aC5sb2cxMChub2RlLnVzZWQpKSA9PT0gYmlnIH07XG4gICAgc3RhcnQgPSBub2RlLnVzZWQgPT09IDAgPyB7IHgsIHkgfSA6IHN0YXJ0O1xuICAgIGRhdGEgPSB5ID09PSAwICYmIHggPiBkYXRhLnggPyB7IHgsIHkgfSA6IGRhdGE7XG4gIH0pO1xuICByZXR1cm4geyBtYXAsIHN0YXJ0LCBkYXRhIH07XG59XG5cbmZ1bmN0aW9uIGdldE5laWdoYm9ycyhtYXAsIHBvaW50KSB7XG4gIHJldHVybiBbXG4gICAgeyB4OiBwb2ludC54IC0gMSwgeTogcG9pbnQueSwgZGlzdGFuY2U6IHBvaW50LmRpc3RhbmNlICsgMSB9LFxuICAgIHsgeDogcG9pbnQueCArIDEsIHk6IHBvaW50LnksIGRpc3RhbmNlOiBwb2ludC5kaXN0YW5jZSArIDEgfSxcbiAgICB7IHg6IHBvaW50LngsIHk6IHBvaW50LnkgLSAxLCBkaXN0YW5jZTogcG9pbnQuZGlzdGFuY2UgKyAxIH0sXG4gICAgeyB4OiBwb2ludC54LCB5OiBwb2ludC55ICsgMSwgZGlzdGFuY2U6IHBvaW50LmRpc3RhbmNlICsgMSB9LFxuICBdLmZpbHRlcihwID0+IG1hcFtjZWxsSWQocCldKTtcbn1cblxuZnVuY3Rpb24gc2hvcnRlc3QobWFwLCBzb3VyY2UsIGRlc3RpbmF0aW9uKSB7XG4gIGxldCBxdWV1ZSA9IFtzb3VyY2VdO1xuICBjb25zdCB2aXNpdGVkID0geyBbY2VsbElkKHNvdXJjZSldOiB7IGRpc3RhbmNlOiAwIH0gfTtcbiAgd2hpbGUgKHF1ZXVlLmxlbmd0aCkge1xuICAgIGNvbnN0IG5leHQgPSBxdWV1ZS5zaGlmdCgpO1xuICAgIGlmIChuZXh0LnggPT09IGRlc3RpbmF0aW9uLnggJiYgbmV4dC55ID09PSBkZXN0aW5hdGlvbi55KSB7XG4gICAgICByZXR1cm4gdmlzaXRlZFtjZWxsSWQobmV4dCldLmRpc3RhbmNlO1xuICAgIH0gZWxzZSB7XG4gICAgICBjb25zdCBuZWlnaGJvcnMgPSBnZXROZWlnaGJvcnMobWFwLCBuZXh0KS5maWx0ZXIoXG4gICAgICAgIHggPT4gIXZpc2l0ZWRbY2VsbElkKHgpXSxcbiAgICAgICk7XG4gICAgICBjb25zdCBkaXN0YW5jZSA9IHZpc2l0ZWRbY2VsbElkKG5leHQpXS5kaXN0YW5jZSArIDE7XG4gICAgICBuZWlnaGJvcnMuZm9yRWFjaCh4ID0+ICh2aXNpdGVkW2NlbGxJZCh4KV0gPSB7IGRpc3RhbmNlIH0pKTtcbiAgICAgIHF1ZXVlID0gcXVldWUuY29uY2F0KG5laWdoYm9ycy5maWx0ZXIoeCA9PiAhbWFwW2NlbGxJZCh4KV0ud2FsbCkpO1xuICAgIH1cbiAgfVxuICByZXR1cm4gMDtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnQxKGlucHV0KSB7XG4gIGNvbnN0IG5vZGVzID0gcGFyc2UoaW5wdXQpO1xuICByZXR1cm4gc29sdmUxKG5vZGVzKS5sZW5ndGg7XG59XG5cbmV4cG9ydCBmdW5jdGlvbiBwYXJ0MihpbnB1dCkge1xuICBjb25zdCBub2RlcyA9IHBhcnNlKGlucHV0KTtcbiAgY29uc3QgeyBtYXAsIHN0YXJ0LCBkYXRhIH0gPSBidWlsZChub2Rlcyk7XG4gIHJldHVybiBzaG9ydGVzdChtYXAsIHN0YXJ0LCB7IHg6IGRhdGEueCAtIDEsIHk6IDAgfSkgKyAxICsgNSAqIChkYXRhLnggLSAxKTtcbn1cbiJdfQ==