69b225c7b44a4dabb7e823304b3e222f
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.part1 = part1;
exports.part2 = part2;

function turnLeft(direction) {
  switch (direction) {
    case 'U':
      return 'L';

    case 'D':
      return 'R';

    case 'L':
      return 'D';

    case 'R':
      return 'U';

    default:
  }
}

function turnRight(direction) {
  switch (direction) {
    case 'U':
      return 'R';

    case 'D':
      return 'L';

    case 'L':
      return 'U';

    case 'R':
      return 'D';

    default:
  }
}

function turnBackward(direction) {
  switch (direction) {
    case 'U':
      return 'D';

    case 'D':
      return 'U';

    case 'L':
      return 'R';

    case 'R':
      return 'L';

    default:
  }
}

function turn(state) {
  const node = state.nodes[toKey(state.position)];

  switch (node) {
    case '#':
      return turnRight(state.direction);

    case 'W':
      return state.direction;

    case 'F':
      return turnBackward(state.direction);

    default:
      return turnLeft(state.direction);
  }
}

function next(node, evolved) {
  switch (node) {
    case '#':
      return evolved ? 'F' : '.';

    case 'W':
      return '#';

    case 'F':
      return '.';

    default:
      return evolved ? 'W' : '#';
  }
}

function move({
  x,
  y
}, direction) {
  switch (direction) {
    case 'U':
      return {
        x,
        y: y - 1
      };

    case 'D':
      return {
        x,
        y: y + 1
      };

    case 'L':
      return {
        x: x - 1,
        y
      };

    case 'R':
      return {
        x: x + 1,
        y
      };

    default:
  }
}

function toKey({
  x,
  y
}) {
  return `${x}:${y}`;
}

function burst(state, evolved) {
  state.direction = turn(state);
  state.nodes[toKey(state.position)] = next(state.nodes[toKey(state.position)], evolved);
  state.infections += state.nodes[toKey(state.position)] === '#' ? 1 : 0;
  state.position = move(state.position, state.direction);
}

function parse(input) {
  const nodes = {};
  const lines = input.split('\n');
  const position = {
    x: (lines[0].length - 1) / 2,
    y: (lines.length - 1) / 2
  };
  lines.forEach((line, y) => line.split('').forEach((node, x) => nodes[toKey({
    x,
    y
  })] = node));
  return {
    nodes,
    position
  };
}

function part1(input, bursts = 1e4, evolved = false) {
  const {
    nodes,
    position
  } = parse(input);
  const state = {
    nodes,
    position,
    direction: 'U',
    infections: 0
  };

  for (let i = 0; i < bursts; i++) {
    burst(state, evolved);
  }

  return state.infections;
}

function part2(input, bursts = 1e7) {
  return part1(input, bursts, true);
}
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImRheTIyLmpzIl0sIm5hbWVzIjpbInR1cm5MZWZ0IiwiZGlyZWN0aW9uIiwidHVyblJpZ2h0IiwidHVybkJhY2t3YXJkIiwidHVybiIsInN0YXRlIiwibm9kZSIsIm5vZGVzIiwidG9LZXkiLCJwb3NpdGlvbiIsIm5leHQiLCJldm9sdmVkIiwibW92ZSIsIngiLCJ5IiwiYnVyc3QiLCJpbmZlY3Rpb25zIiwicGFyc2UiLCJpbnB1dCIsImxpbmVzIiwic3BsaXQiLCJsZW5ndGgiLCJmb3JFYWNoIiwibGluZSIsInBhcnQxIiwiYnVyc3RzIiwiaSIsInBhcnQyIl0sIm1hcHBpbmdzIjoiOzs7Ozs7OztBQUFBLFNBQVNBLFFBQVQsQ0FBa0JDLFNBQWxCLEVBQTZCO0FBQzNCLFVBQVFBLFNBQVI7QUFDRSxTQUFLLEdBQUw7QUFDRSxhQUFPLEdBQVA7O0FBQ0YsU0FBSyxHQUFMO0FBQ0UsYUFBTyxHQUFQOztBQUNGLFNBQUssR0FBTDtBQUNFLGFBQU8sR0FBUDs7QUFDRixTQUFLLEdBQUw7QUFDRSxhQUFPLEdBQVA7O0FBQ0Y7QUFURjtBQVdEOztBQUVELFNBQVNDLFNBQVQsQ0FBbUJELFNBQW5CLEVBQThCO0FBQzVCLFVBQVFBLFNBQVI7QUFDRSxTQUFLLEdBQUw7QUFDRSxhQUFPLEdBQVA7O0FBQ0YsU0FBSyxHQUFMO0FBQ0UsYUFBTyxHQUFQOztBQUNGLFNBQUssR0FBTDtBQUNFLGFBQU8sR0FBUDs7QUFDRixTQUFLLEdBQUw7QUFDRSxhQUFPLEdBQVA7O0FBQ0Y7QUFURjtBQVdEOztBQUVELFNBQVNFLFlBQVQsQ0FBc0JGLFNBQXRCLEVBQWlDO0FBQy9CLFVBQVFBLFNBQVI7QUFDRSxTQUFLLEdBQUw7QUFDRSxhQUFPLEdBQVA7O0FBQ0YsU0FBSyxHQUFMO0FBQ0UsYUFBTyxHQUFQOztBQUNGLFNBQUssR0FBTDtBQUNFLGFBQU8sR0FBUDs7QUFDRixTQUFLLEdBQUw7QUFDRSxhQUFPLEdBQVA7O0FBQ0Y7QUFURjtBQVdEOztBQUVELFNBQVNHLElBQVQsQ0FB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QUFLLENBQUNOLEtBQUQsRUFBUU8sTUFBUixFQUFnQixJQUFoQixDQUFaO0FBQ0QiLCJzb3VyY2VzQ29udGVudCI6WyJmdW5jdGlvbiB0dXJuTGVmdChkaXJlY3Rpb24pIHtcbiAgc3dpdGNoIChkaXJlY3Rpb24pIHtcbiAgICBjYXNlICdVJzpcbiAgICAgIHJldHVybiAnTCc7XG4gICAgY2FzZSAnRCc6XG4gICAgICByZXR1cm4gJ1InO1xuICAgIGNhc2UgJ0wnOlxuICAgICAgcmV0dXJuICdEJztcbiAgICBjYXNlICdSJzpcbiAgICAgIHJldHVybiAnVSc7XG4gICAgZGVmYXVsdDpcbiAgfVxufVxuXG5mdW5jdGlvbiB0dXJuUmlnaHQoZGlyZWN0aW9uKSB7XG4gIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgY2FzZSAnVSc6XG4gICAgICByZXR1cm4gJ1InO1xuICAgIGNhc2UgJ0QnOlxuICAgICAgcmV0dXJuICdMJztcbiAgICBjYXNlICdMJzpcbiAgICAgIHJldHVybiAnVSc7XG4gICAgY2FzZSAnUic6XG4gICAgICByZXR1cm4gJ0QnO1xuICAgIGRlZmF1bHQ6XG4gIH1cbn1cblxuZnVuY3Rpb24gdHVybkJhY2t3YXJkKGRpcmVjdGlvbikge1xuICBzd2l0Y2ggKGRpcmVjdGlvbikge1xuICAgIGNhc2UgJ1UnOlxuICAgICAgcmV0dXJuICdEJztcbiAgICBjYXNlICdEJzpcbiAgICAgIHJldHVybiAnVSc7XG4gICAgY2FzZSAnTCc6XG4gICAgICByZXR1cm4gJ1InO1xuICAgIGNhc2UgJ1InOlxuICAgICAgcmV0dXJuICdMJztcbiAgICBkZWZhdWx0OlxuICB9XG59XG5cbmZ1bmN0aW9uIHR1cm4oc3RhdGUpIHtcbiAgY29uc3Qgbm9kZSA9IHN0YXRlLm5vZGVzW3RvS2V5KHN0YXRlLnBvc2l0aW9uKV07XG4gIHN3aXRjaCAobm9kZSkge1xuICAgIGNhc2UgJyMnOlxuICAgICAgcmV0dXJuIHR1cm5SaWdodChzdGF0ZS5kaXJlY3Rpb24pO1xuICAgIGNhc2UgJ1cnOlxuICAgICAgcmV0dXJuIHN0YXRlLmRpcmVjdGlvbjtcbiAgICBjYXNlICdGJzpcbiAgICAgIHJldHVybiB0dXJuQmFja3dhcmQoc3RhdGUuZGlyZWN0aW9uKTtcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIHR1cm5MZWZ0KHN0YXRlLmRpcmVjdGlvbik7XG4gIH1cbn1cblxuZnVuY3Rpb24gbmV4dChub2RlLCBldm9sdmVkKSB7XG4gIHN3aXRjaCAobm9kZSkge1xuICAgIGNhc2UgJyMnOlxuICAgICAgcmV0dXJuIGV2b2x2ZWQgPyAnRicgOiAnLic7XG4gICAgY2FzZSAnVyc6XG4gICAgICByZXR1cm4gJyMnO1xuICAgIGNhc2UgJ0YnOlxuICAgICAgcmV0dXJuICcuJztcbiAgICBkZWZhdWx0OlxuICAgICAgcmV0dXJuIGV2b2x2ZWQgPyAnVycgOiAnIyc7XG4gIH1cbn1cblxuZnVuY3Rpb24gbW92ZSh7IHgsIHkgfSwgZGlyZWN0aW9uKSB7XG4gIHN3aXRjaCAoZGlyZWN0aW9uKSB7XG4gICAgY2FzZSAnVSc6XG4gICAgICByZXR1cm4geyB4LCB5OiB5IC0gMSB9O1xuICAgIGNhc2UgJ0QnOlxuICAgICAgcmV0dXJuIHsgeCwgeTogeSArIDEgfTtcbiAgICBjYXNlICdMJzpcbiAgICAgIHJldHVybiB7IHg6IHggLSAxLCB5IH07XG4gICAgY2FzZSAnUic6XG4gICAgICByZXR1cm4geyB4OiB4ICsgMSwgeSB9O1xuICAgIGRlZmF1bHQ6XG4gIH1cbn1cblxuZnVuY3Rpb24gdG9LZXkoeyB4LCB5IH0pIHtcbiAgcmV0dXJuIGAke3h9OiR7eX1gO1xufVxuXG5mdW5jdGlvbiBidXJzdChzdGF0ZSwgZXZvbHZlZCkge1xuICBzdGF0ZS5kaXJlY3Rpb24gPSB0dXJuKHN0YXRlKTtcbiAgc3RhdGUubm9kZXNbdG9LZXkoc3RhdGUucG9zaXRpb24pXSA9IG5leHQoXG4gICAgc3RhdGUubm9kZXNbdG9LZXkoc3RhdGUucG9zaXRpb24pXSxcbiAgICBldm9sdmVkLFxuICApO1xuICBzdGF0ZS5pbmZlY3Rpb25zICs9IHN0YXRlLm5vZGVzW3RvS2V5KHN0YXRlLnBvc2l0aW9uKV0gPT09ICcjJyA/IDEgOiAwO1xuICBzdGF0ZS5wb3NpdGlvbiA9IG1vdmUoc3RhdGUucG9zaXRpb24sIHN0YXRlLmRpcmVjdGlvbik7XG59XG5cbmZ1bmN0aW9uIHBhcnNlKGlucHV0KSB7XG4gIGNvbnN0IG5vZGVzID0ge307XG4gIGNvbnN0IGxpbmVzID0gaW5wdXQuc3BsaXQoJ1xcbicpO1xuICBjb25zdCBwb3NpdGlvbiA9IHsgeDogKGxpbmVzWzBdLmxlbmd0aCAtIDEpIC8gMiwgeTogKGxpbmVzLmxlbmd0aCAtIDEpIC8gMiB9O1xuICBsaW5lcy5mb3JFYWNoKChsaW5lLCB5KSA9PlxuICAgIGxpbmUuc3BsaXQoJycpLmZvckVhY2goKG5vZGUsIHgpID0+IChub2Rlc1t0b0tleSh7IHgsIHkgfSldID0gbm9kZSkpLFxuICApO1xuICByZXR1cm4geyBub2RlcywgcG9zaXRpb24gfTtcbn1cblxuZXhwb3J0IGZ1bmN0aW9uIHBhcnQxKGlucHV0LCBidXJzdHMgPSAxZTQsIGV2b2x2ZWQgPSBmYWxzZSkge1xuICBjb25zdCB7IG5vZGVzLCBwb3NpdGlvbiB9ID0gcGFyc2UoaW5wdXQpO1xuICBjb25zdCBzdGF0ZSA9IHsgbm9kZXMsIHBvc2l0aW9uLCBkaXJlY3Rpb246ICdVJywgaW5mZWN0aW9uczogMCB9O1xuICBmb3IgKGxldCBpID0gMDsgaSA8IGJ1cnN0czsgaSsrKSB7XG4gICAgYnVyc3Qoc3RhdGUsIGV2b2x2ZWQpO1xuICB9XG4gIHJldHVybiBzdGF0ZS5pbmZlY3Rpb25zO1xufVxuXG5leHBvcnQgZnVuY3Rpb24gcGFydDIoaW5wdXQsIGJ1cnN0cyA9IDFlNykge1xuICByZXR1cm4gcGFydDEoaW5wdXQsIGJ1cnN0cywgdHJ1ZSk7XG59XG4iXX0=