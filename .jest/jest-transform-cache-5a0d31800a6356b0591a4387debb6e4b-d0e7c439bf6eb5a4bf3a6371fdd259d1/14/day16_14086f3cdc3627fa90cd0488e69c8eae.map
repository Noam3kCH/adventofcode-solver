{"version":3,"sources":["day16.js"],"names":["ops","addr","r","i1","i2","o","addi","mulr","muli","banr","bani","borr","bori","setr","seti","gtir","gtri","gtrr","eqir","eqri","eqrr","numbers","arr","map","x","parseInt","parseSamples","input","samples","split","sample","before","instruction","after","regex","r1","r2","r3","r4","match","o1","o2","o3","o4","op","params","options","Object","keys","filter","join","part1","s","length","part2","result","dic","Array","fill","forEach","includes","some","done","program","pop","commands"],"mappings":"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","sourcesContent":["const ops = {\n  addr: (r, i1, i2, o) => (r[o] = r[i1] + r[i2]),\n  addi: (r, i1, i2, o) => (r[o] = r[i1] + i2),\n  mulr: (r, i1, i2, o) => (r[o] = r[i1] * r[i2]),\n  muli: (r, i1, i2, o) => (r[o] = r[i1] * i2),\n  banr: (r, i1, i2, o) => (r[o] = r[i1] & r[i2]),\n  bani: (r, i1, i2, o) => (r[o] = r[i1] & i2),\n  borr: (r, i1, i2, o) => (r[o] = r[i1] | r[i2]),\n  bori: (r, i1, i2, o) => (r[o] = r[i1] | i2),\n  setr: (r, i1, i2, o) => (r[o] = r[i1]),\n  seti: (r, i1, i2, o) => (r[o] = i1),\n  gtir: (r, i1, i2, o) => (r[o] = i1 > r[i2] ? 1 : 0),\n  gtri: (r, i1, i2, o) => (r[o] = r[i1] > i2 ? 1 : 0),\n  gtrr: (r, i1, i2, o) => (r[o] = r[i1] > r[i2] ? 1 : 0),\n  eqir: (r, i1, i2, o) => (r[o] = i1 === r[i2] ? 1 : 0),\n  eqri: (r, i1, i2, o) => (r[o] = r[i1] === i2 ? 1 : 0),\n  eqrr: (r, i1, i2, o) => (r[o] = r[i1] === r[i2] ? 1 : 0),\n};\nconst numbers = arr => arr.map(x => parseInt(x));\n\nfunction parseSamples(input) {\n  const samples = input.split('\\n\\n\\n\\n')[0].split('\\n\\n');\n  return samples.map(sample => {\n    const [before, instruction, after] = sample.split('\\n');\n    const regex = /\\[(\\d+), (\\d+), (\\d+), (\\d+)\\]/;\n    const [, r1, r2, r3, r4] = numbers(before.match(regex));\n    const [, o1, o2, o3, o4] = numbers(after.match(regex));\n    const [op, ...params] = numbers(instruction.split(' '));\n    const options = Object.keys(ops).filter(op => {\n      const r = [r1, r2, r3, r4];\n      const o = [o1, o2, o3, o4];\n      ops[op](r, ...params);\n      return r.join(',') === o.join(',');\n    });\n    return { op, options };\n  });\n}\n\nexport function part1(input) {\n  return parseSamples(input).filter(s => s.options.length >= 3).length;\n}\n\nexport function part2(input) {\n  const result = parseSamples(input);\n  let dic = new Array(Object.keys(ops).length).fill();\n  dic = dic.map(() => Object.keys(ops));\n  result.forEach(({ op, options }) => {\n    dic[op] = dic[op].filter(x => options.includes(x));\n  });\n  while (dic.some(x => x.length > 1)) {\n    const done = dic.filter(x => x.length === 1).map(x => x[0]);\n    dic = dic.map(x => (x.length > 1 ? x.filter(op => !done.includes(op)) : x));\n  }\n\n  const program = input.split('\\n\\n\\n\\n').pop();\n  const commands = program.split('\\n').map(x => numbers(x.split(' ')));\n  const r = [0, 0, 0, 0];\n  commands.forEach(([op, ...params]) => ops[dic[op][0]](r, ...params));\n  return r[0];\n}\n"]}