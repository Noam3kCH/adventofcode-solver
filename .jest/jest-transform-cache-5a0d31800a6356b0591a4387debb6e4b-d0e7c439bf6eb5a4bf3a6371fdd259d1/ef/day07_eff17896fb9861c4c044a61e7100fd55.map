{"version":3,"sources":["day07.js"],"names":["ops","AND","p1","p2","Math","pow","OR","NOT","LSHIFT","RSHIFT","undefined","getter","id","match","circuit","parseInt","makeCircuit","input","map","x","op","result","reduce","gate","memo","part1","split","a","part2","concat"],"mappings":"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","sourcesContent":["/* eslint no-bitwise: \"off\" */\nconst ops = {\n  AND: (p1, p2) => (Math.pow(2, 16) + (p1 & p2)) % Math.pow(2, 16),\n  OR: (p1, p2) => (Math.pow(2, 16) + (p1 | p2)) % Math.pow(2, 16),\n  NOT: (p1, p2) => (Math.pow(2, 16) + ~p2) % Math.pow(2, 16),\n  LSHIFT: (p1, p2) => (Math.pow(2, 16) + (p1 << p2)) % Math.pow(2, 16),\n  RSHIFT: (p1, p2) => (Math.pow(2, 16) + (p1 >> p2)) % Math.pow(2, 16),\n  undefined: p1 => (Math.pow(2, 16) + p1) % Math.pow(2, 16),\n};\n\nfunction getter(id) {\n  return id && id.match(/^[a-z]+$/)\n    ? circuit => circuit[id]()\n    : () => parseInt(id);\n}\n\nfunction makeCircuit(input) {\n  return input\n    .map(x =>\n      x.match(/^(?:(\\w+) )?(?:(AND|OR|NOT|LSHIFT|RSHIFT) (\\w+) )?-> (\\w+)$/),\n    )\n    .map(x => ({\n      op: ops[x[2] + ''],\n      p1: getter(x[1]),\n      p2: getter(x[3]),\n      result: x[4],\n    }))\n    .reduce((circuit, gate) => {\n      circuit[gate.result] = () => {\n        const memo = gate.op(gate.p1(circuit), gate.p2(circuit));\n        circuit[gate.result] = () => memo;\n        return memo;\n      };\n      return circuit;\n    }, {});\n}\n\nexport const part1 = input => makeCircuit(input.split('\\n')).a();\nexport const part2 = input =>\n  makeCircuit(input.split('\\n').concat(`${part1(input)} -> b`)).a();\n"]}